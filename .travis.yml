osx_image: xcode10.2
language: objective-c

notifications:
  email: false

# branches:
#   only:
#   - master

cache: cocoapods
podfile: Demo/Podfile

before_install:
    - gem install cocoapods --no-document --quiet
    - gem install xcpretty --no-document --quiet
    - pod --version
    - pod repo update --silent
    - xcpretty --version
    - xcodebuild -version
    - xcodebuild -showsdks

script:
  - echo Pod
  - pod lib lint --allow-warnings

  - echo Clean DerivedData
  - rm -rf ~/Library/Developer/Xcode/DerivedData/

  - cd Demo
  - pod install
  - xcodebuild clean build -workspace XYChart.xcworkspace -scheme 'XYChart' -sdk iphonesimulator -destination 'platform=iOS Simulator,name=iPhone XS' -configuration Debug | xcpretty -c

deploy:
  provider: script
  script: ./scripts/push.sh
  on:
    tags: true